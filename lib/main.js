// Generated by CoffeeScript 1.4.0
var ProjectBuilder, cliParser, normalizeBuildOptions;

cliParser = require('./cli-parser');

ProjectBuilder = require('./build/ProjectBuilder').ProjectBuilder;

exports.main = function() {
  /*
    Main cordjs CLI tool entry point.
  */
  return cliParser.run({
    build: function(options) {
      /*
            Builds whole project.
      */

      var builder;
      console.log("Building project with options", options);
      builder = new ProjectBuilder(normalizeBuildOptions(options));
      return builder.build();
    },
    run: function(options) {
      /*
            Builds project and starts cordjs server
      */

      var builder;
      console.log("Starting cordjs server with options", options);
      builder = new ProjectBuilder(normalizeBuildOptions(options));
      builder.build();
      return builder.on('complete', function() {});
    },
    clean: function() {
      return console.log("Cleaning project...");
    }
  });
};

normalizeBuildOptions = function(options) {
  var curDir;
  if (options.parent.chdir) {
    process.chdir(options.parent.chdir);
  }
  curDir = process.cwd();
  return {
    baseDir: curDir,
    targetDir: "" + curDir + "/" + options.out,
    watch: !!options.watch,
    debug: !!options.debug
  };
};
